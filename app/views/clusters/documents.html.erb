<% content_for(:subtitle) { 'Documents' } %>
<%= render 'partials/tabs', activate: :documents do %>
  <ul class="list-group list-group-flush">
    <% cluster.documents.each do |document| %>
      <li class="list-group-item">
        <i class="fa fa-file-o mr-2"></i>
        <%= link_to document.name, document.url, target: '_blank' %>
      </li>
    <% end %>
    <% cluster.notes.each do |note| %>
      <% if policy(note).permitted? %>
        <li class="list-group-item">

          <% if note.visibility == 'engineering' %>
            <i class="fa fa-lock mr-2" title="This document is only visible to engineers"></i>
          <% else %>
            <i class="fa fa-file-text-o mr-2"></i>
          <% end %>

          <%= link_to note.title, cluster_note_path(cluster, note) %>

          <% if policy(note).edit? %>
            <%=
              link_to raw('<i class="fa fa-pencil fa-pull-right" title="This document is editable"></i>'),
                      edit_cluster_note_path(cluster, note)
            %>
          <% end %>
        </li>
      <% end %>
    <% end %>
  </ul>
  <% if policy(Note).create? %>
    <%=
      link_to 'Add new document',
              new_cluster_note_path(cluster),
              class: 'btn btn-primary'
    %>
  <% end %>
<% end %>
